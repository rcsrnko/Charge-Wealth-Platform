import{r as i,j as e}from"./index-DZFJU_ZF.js";const P="_container_1q600_1",M="_mainPanel_1q600_7",H="_header_1q600_14",D="_headerContent_1q600_23",W="_title_1q600_29",E="_subtitle_1q600_36",Q="_documentBadge_1q600_42",F="_headerActions_1q600_60",G="_memoButton_1q600_65",O="_contextButton_1q600_66",z="_contextBar_1q600_104",V="_contextLabel_1q600_114",$="_contextBadge_1q600_121",R="_contextEmpty_1q600_132",Y="_chatArea_1q600_145",J="_welcome_1q600_152",K="_welcomeIcon_1q600_159",U="_emptyState_1q600_185",X="_lockIcon_1q600_196",Z="_requirements_1q600_224",ee="_completeOnboardingBtn_1q600_252",se="_starterQuestions_1q600_365",te="_starterLabel_1q600_371",ne="_starterQuestion_1q600_365",ae="_messages_1q600_396",oe="_message_1q600_396",ie="_userMessage_1q600_409",ce="_messageContent_1q600_413",le="_assistantMessage_1q600_420",re="_citations_1q600_440",de="_citationLabel_1q600_449",he="_citation_1q600_440",me="_typingIndicator_1q600_463",xe="_inputArea_1q600_488",_e="_input_1q600_488",ue="_sendButton_1q600_517",pe="_memoPanel_1q600_540",je="_memoPanelTitle_1q600_548",ve="_memoEmpty_1q600_555",ge="_memoList_1q600_572",ye="_memoCard_1q600_578",ke="_memoDate_1q600_599",qe="_proactivePanel_1q600_1033",Ne="_proactiveHeader_1q600_1043",fe="_proactiveTitle_1q600_1052",Ce="_proactiveClose_1q600_1066",be="_proactiveGreeting_1q600_1084",we="_sectionTitle_1q600_1091",Ie="_urgentActions_1q600_1100",Te="_actionCard_1q600_1104",Ae="_actionHeader_1q600_1115",Be="_actionTitle_1q600_1122",Le="_actionDeadline_1q600_1128",Se="_actionWhy_1q600_1136",Pe="_actionImpact_1q600_1143",Me="_actionSteps_1q600_1150",He="_weeklyCheckIn_1q600_1161",De="_statusGrid_1q600_1165",We="_statusItem_1q600_1171",Ee="_statusLabel_1q600_1177",Qe="_bigPicture_1q600_1194",Fe="_nextStepsSection_1q600_1208",Ge="_focusGrid_1q600_1212",Oe="_focusItem_1q600_1218",ze="_focusLabel_1q600_1224",Ve="_skeletonAnalysis_1q600_1268",$e="_skeletonHeader_1q600_1274",Re="_skeletonIcon_1q600_1281",Ye="_skeletonTitle_1q600_1290",Je="_skeletonLine_1q600_1299",Ke="_skeletonCards_1q600_1309",Ue="_skeletonCard_1q600_1309",Xe="_skeletonText_1q600_1324",Ze="_typingDemo_1q600_1336",es="_typingBubble_1q600_1340",ss="_typingText_1q600_1350",ts="_typingCursor_1q600_1356",ns="_testimonialQuote_1q600_1370",as="_quoteIcon_1q600_1379",os="_quoteText_1q600_1387",is="_quoteAuthor_1q600_1395",s={container:P,mainPanel:M,header:H,headerContent:D,title:W,subtitle:E,documentBadge:Q,headerActions:F,memoButton:G,contextButton:O,contextBar:z,contextLabel:V,contextBadge:$,contextEmpty:R,chatArea:Y,welcome:J,welcomeIcon:K,emptyState:U,lockIcon:X,requirements:Z,completeOnboardingBtn:ee,starterQuestions:se,starterLabel:te,starterQuestion:ne,messages:ae,message:oe,userMessage:ie,messageContent:ce,assistantMessage:le,citations:re,citationLabel:de,citation:he,typingIndicator:me,inputArea:xe,input:_e,sendButton:ue,memoPanel:pe,memoPanelTitle:je,memoEmpty:ve,memoList:ge,memoCard:ye,memoDate:ke,proactivePanel:qe,proactiveHeader:Ne,proactiveTitle:fe,proactiveClose:Ce,proactiveGreeting:be,sectionTitle:we,urgentActions:Ie,actionCard:Te,actionHeader:Ae,actionTitle:Be,actionDeadline:Le,actionWhy:Se,actionImpact:Pe,actionSteps:Me,weeklyCheckIn:He,statusGrid:De,statusItem:We,statusLabel:Ee,bigPicture:Qe,nextStepsSection:Fe,focusGrid:Ge,focusItem:Oe,focusLabel:ze,skeletonAnalysis:Ve,skeletonHeader:$e,skeletonIcon:Re,skeletonTitle:Ye,skeletonLine:Je,skeletonCards:Ke,skeletonCard:Ue,skeletonText:Xe,typingDemo:Ze,typingBubble:es,typingText:ss,typingCursor:ts,testimonialQuote:ns,quoteIcon:as,quoteText:os,quoteAuthor:is};function ls(){const[l,_]=i.useState([]),[h,u]=i.useState(""),[d,m]=i.useState(!1),[p,j]=i.useState(!1),[v,g]=i.useState([]),[c,f]=i.useState(null),y=i.useRef(null),[a,C]=i.useState(null),[b,k]=i.useState(!1),[w,I]=i.useState(!0);i.useEffect(()=>{T(),A(),B()},[]),i.useEffect(()=>{y.current?.scrollIntoView({behavior:"smooth"})},[l]);const T=async()=>{try{const t=await fetch("/api/charge-ai/context",{credentials:"include"});if(t.ok){const n=await t.json();f(n)}}catch(t){console.error("Failed to load context:",t)}},A=async()=>{try{const t=await fetch("/api/charge-ai/memos",{credentials:"include"});if(t.ok){const n=await t.json();g(n.memos||[])}}catch(t){console.error("Failed to load memos:",t)}},B=async()=>{k(!0);try{const t=await fetch("/api/charge-ai/proactive-analysis",{credentials:"include"});if(t.ok){const n=await t.json();n.hasAnalysis&&n.analysis&&C(n.analysis)}}catch(t){console.error("Failed to load proactive analysis:",t)}finally{k(!1)}},q=async()=>{if(!h.trim()||d)return;const t={role:"user",content:h.trim(),timestamp:new Date};_(n=>[...n,t]),u(""),m(!0);try{const n=await fetch("/api/charge-ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({message:t.content,conversationHistory:l.map(x=>({role:x.role,content:x.content}))})});if(!n.ok)throw new Error("Failed to get response");const o=await n.json(),r={role:"assistant",content:o.response,timestamp:new Date,citations:o.citations};_(x=>[...x,r])}catch(n){console.error("Chat error:",n),_(o=>[...o,{role:"assistant",content:"I encountered an issue processing your request. Please try again.",timestamp:new Date}])}finally{m(!1)}},L=async()=>{if(!(l.length<2)){m(!0);try{const t=await fetch("/api/charge-ai/generate-memo",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({messages:l.map(n=>({role:n.role,content:n.content}))})});if(t.ok){const n=await t.json();g(o=>[n.memo,...o]),j(!0)}}catch(t){console.error("Failed to generate memo:",t)}finally{m(!1)}}},S=["How much will I save if I max out my 401k this year?","What's my current tax situation and biggest opportunities?","Help me build my financial profile step by step","What should I focus on first given my situation?"],N=c?.hasTaxData||c?.hasPositions||c?.hasProfile;return e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.mainPanel,children:[e.jsxs("div",{className:s.header,children:[e.jsxs("div",{className:s.headerContent,children:[e.jsx("h1",{className:s.title,children:"AI Advisor"}),e.jsx("p",{className:s.subtitle,children:"Your private decision engine"}),c?.hasAnalyzedDocuments&&e.jsxs("div",{className:s.documentBadge,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"14",height:"14",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),e.jsxs("span",{children:["AI has analyzed ",c.documentCount||1," document",(c.documentCount||1)>1?"s":""]})]})]}),e.jsxs("div",{className:s.headerActions,children:[l.length>=2&&e.jsxs("button",{className:s.memoButton,onClick:L,disabled:d,children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Save Memo"]}),e.jsxs("button",{className:s.contextButton,onClick:()=>j(!p),children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),e.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]}),p?"Hide":"Memos"]})]})]}),c&&e.jsxs("div",{className:s.contextBar,children:[e.jsx("span",{className:s.contextLabel,children:"Your data:"}),c.hasProfile&&e.jsx("span",{className:s.contextBadge,children:"Profile"}),c.hasTaxData&&e.jsx("span",{className:s.contextBadge,children:"Tax Return"}),c.hasPositions&&e.jsx("span",{className:s.contextBadge,children:"Portfolio"}),!N&&e.jsx("span",{className:s.contextEmpty,children:"No data uploaded yet"})]}),e.jsx("div",{className:s.chatArea,children:l.length===0?e.jsx("div",{className:s.welcome,children:a&&w?e.jsxs("div",{className:s.proactivePanel,children:[e.jsxs("div",{className:s.proactiveHeader,children:[e.jsxs("div",{className:s.proactiveTitle,children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"})}),e.jsx("span",{children:"Your Personal CFO Update"})]}),e.jsx("button",{className:s.proactiveClose,onClick:()=>I(!1),children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),e.jsx("p",{className:s.proactiveGreeting,children:a.greeting}),a.urgentActions&&a.urgentActions.length>0&&e.jsxs("div",{className:s.urgentActions,children:[e.jsx("h3",{className:s.sectionTitle,children:"Action Items"}),a.urgentActions.map((t,n)=>e.jsxs("div",{className:s.actionCard,children:[e.jsxs("div",{className:s.actionHeader,children:[e.jsx("span",{className:s.actionTitle,children:t.title}),t.deadline&&e.jsx("span",{className:s.actionDeadline,children:t.deadline})]}),e.jsx("p",{className:s.actionWhy,children:t.why}),e.jsxs("div",{className:s.actionImpact,children:["Impact: ",t.impact]}),t.steps&&t.steps.length>0&&e.jsx("ol",{className:s.actionSteps,children:t.steps.map((o,r)=>e.jsx("li",{children:o},r))})]},n))]}),a.weeklyCheckIn&&e.jsxs("div",{className:s.weeklyCheckIn,children:[e.jsx("h3",{className:s.sectionTitle,children:"Status Check"}),e.jsxs("div",{className:s.statusGrid,children:[e.jsxs("div",{className:s.statusItem,children:[e.jsx("span",{className:s.statusLabel,children:"Portfolio"}),e.jsx("p",{children:a.weeklyCheckIn.portfolioStatus})]}),e.jsxs("div",{className:s.statusItem,children:[e.jsx("span",{className:s.statusLabel,children:"Taxes"}),e.jsx("p",{children:a.weeklyCheckIn.taxStatus})]}),e.jsxs("div",{className:s.statusItem,children:[e.jsx("span",{className:s.statusLabel,children:"Cash Flow"}),e.jsx("p",{children:a.weeklyCheckIn.cashFlowStatus})]})]})]}),e.jsxs("div",{className:s.bigPicture,children:[e.jsx("h3",{className:s.sectionTitle,children:"Big Picture"}),e.jsx("p",{children:a.bigPictureInsight})]}),a.nextSteps&&e.jsxs("div",{className:s.nextStepsSection,children:[e.jsx("h3",{className:s.sectionTitle,children:"Focus Areas"}),e.jsxs("div",{className:s.focusGrid,children:[e.jsxs("div",{className:s.focusItem,children:[e.jsx("span",{className:s.focusLabel,children:"This Week"}),e.jsx("p",{children:a.nextSteps.thisWeek})]}),e.jsxs("div",{className:s.focusItem,children:[e.jsx("span",{className:s.focusLabel,children:"This Month"}),e.jsx("p",{children:a.nextSteps.thisMonth})]}),e.jsxs("div",{className:s.focusItem,children:[e.jsx("span",{className:s.focusLabel,children:"This Quarter"}),e.jsx("p",{children:a.nextSteps.thisQuarter})]})]})]})]}):b?e.jsxs("div",{className:s.skeletonAnalysis,children:[e.jsxs("div",{className:s.skeletonHeader,children:[e.jsx("div",{className:s.skeletonIcon}),e.jsx("div",{className:s.skeletonTitle})]}),e.jsx("div",{className:s.skeletonLine}),e.jsx("div",{className:s.skeletonLine,style:{width:"80%"}}),e.jsxs("div",{className:s.skeletonCards,children:[e.jsx("div",{className:s.skeletonCard}),e.jsx("div",{className:s.skeletonCard})]}),e.jsx("p",{className:s.skeletonText,children:"Loading your personalized insights..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:s.welcomeIcon,children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"}),e.jsx("circle",{cx:"8",cy:"14",r:"1.5"}),e.jsx("circle",{cx:"16",cy:"14",r:"1.5"})]})}),N?e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Ask any financial question"}),e.jsx("p",{children:"I'll analyze your data and give you specific answers with real numbers."})]}):e.jsxs("div",{className:s.emptyState,children:[e.jsx("div",{className:s.typingDemo,children:e.jsxs("div",{className:s.typingBubble,children:[e.jsx("span",{className:s.typingText,children:'"How can I reduce my tax bill by $5,000 this year?"'}),e.jsx("span",{className:s.typingCursor})]})}),e.jsx("div",{className:s.lockIcon,children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"5",y:"11",width:"14",height:"10",rx:"2",ry:"2"}),e.jsx("path",{d:"M12 17v-3"}),e.jsx("path",{d:"M7 11V7a5 5 0 0110 0v4"})]})}),e.jsx("h2",{children:"Complete Onboarding to Unlock AI Advisor"}),e.jsx("p",{children:"To provide personalized insights, I need information about your:"}),e.jsxs("ul",{className:s.requirements,children:[e.jsxs("li",{children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Tax profile and income"]}),e.jsxs("li",{children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Investment portfolio"]}),e.jsxs("li",{children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Tax documents (optional)"]})]}),e.jsxs("div",{className:s.testimonialQuote,children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:s.quoteIcon,children:e.jsx("path",{d:"M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"})}),e.jsx("p",{className:s.quoteText,children:`"Found $12,000 in tax savings I didn't know existed. The AI advisor paid for itself in the first conversation."`}),e.jsx("span",{className:s.quoteAuthor,children:"â€” Sarah K., Tech Executive"})]}),e.jsxs("button",{className:s.completeOnboardingBtn,onClick:()=>window.location.href="/dashboard?showOnboarding=true",children:["Complete Onboarding (5 min)",e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]})]}),e.jsxs("div",{className:s.starterQuestions,children:[e.jsx("span",{className:s.starterLabel,children:"Try asking:"}),S.map((t,n)=>e.jsx("button",{className:s.starterQuestion,onClick:()=>u(t),children:t},n))]})]})}):e.jsxs("div",{className:s.messages,children:[l.map((t,n)=>e.jsxs("div",{className:`${s.message} ${t.role==="user"?s.userMessage:s.assistantMessage}`,children:[e.jsx("div",{className:s.messageContent,children:t.content.split(`
`).map((o,r)=>e.jsx("p",{children:o},r))}),t.citations&&t.citations.length>0&&e.jsxs("div",{className:s.citations,children:[e.jsx("span",{className:s.citationLabel,children:"Based on:"}),t.citations.map((o,r)=>e.jsx("span",{className:s.citation,children:o},r))]})]},n)),d&&e.jsx("div",{className:`${s.message} ${s.assistantMessage}`,children:e.jsxs("div",{className:s.typingIndicator,children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})}),e.jsx("div",{ref:y})]})}),e.jsxs("div",{className:s.inputArea,children:[e.jsx("input",{type:"text",value:h,onChange:t=>u(t.target.value),onKeyDown:t=>t.key==="Enter"&&q(),placeholder:"Ask a question about your finances...",className:s.input,disabled:d}),e.jsx("button",{onClick:q,className:s.sendButton,disabled:!h.trim()||d,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),e.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),p&&e.jsxs("div",{className:s.memoPanel,children:[e.jsx("h3",{className:s.memoPanelTitle,children:"Saved Memos"}),v.length===0?e.jsx("div",{className:s.memoEmpty,children:e.jsx("p",{children:"Save important insights and decisions for later reference."})}):e.jsx("div",{className:s.memoList,children:v.map(t=>e.jsxs("div",{className:s.memoCard,children:[e.jsx("h4",{children:t.title}),e.jsx("p",{children:t.summary}),e.jsx("span",{className:s.memoDate,children:new Date(t.createdAt).toLocaleDateString()})]},t.id))})]})]})}export{ls as default};
