import{r as i,j as e,L as M}from"./index-Bh30mIGX.js";const D="_container_1stvu_1",H="_mainPanel_1stvu_7",W="_header_1stvu_14",q="_headerContent_1stvu_23",E="_title_1stvu_29",Q="_subtitle_1stvu_36",z="_documentBadge_1stvu_42",F="_headerActions_1stvu_60",G="_memoButton_1stvu_65",O="_contextButton_1stvu_66",V="_contextBar_1stvu_104",$="_contextLabel_1stvu_114",R="_contextBadge_1stvu_121",Y="_contextEmpty_1stvu_132",J="_chatArea_1stvu_145",K="_welcome_1stvu_152",U="_welcomeIcon_1stvu_159",X="_emptyState_1stvu_185",Z="_lockIcon_1stvu_196",ee="_requirements_1stvu_224",se="_completeOnboardingBtn_1stvu_252",te="_starterQuestions_1stvu_365",ne="_starterLabel_1stvu_371",ae="_starterQuestion_1stvu_365",oe="_messages_1stvu_396",ie="_message_1stvu_396",ce="_userMessage_1stvu_409",re="_messageContent_1stvu_413",le="_assistantMessage_1stvu_420",de="_citations_1stvu_440",ue="_citationLabel_1stvu_449",he="_citation_1stvu_440",me="_typingIndicator_1stvu_463",xe="_inputArea_1stvu_488",_e="_input_1stvu_488",pe="_sendButton_1stvu_517",ve="_memoPanel_1stvu_540",je="_memoPanelTitle_1stvu_548",ge="_memoEmpty_1stvu_555",ye="_memoList_1stvu_572",Ne="_memoCard_1stvu_578",fe="_memoDate_1stvu_599",ke="_proactivePanel_1stvu_1033",be="_proactiveHeader_1stvu_1043",we="_proactiveTitle_1stvu_1052",Ce="_proactiveClose_1stvu_1066",Ie="_proactiveGreeting_1stvu_1084",Ae="_sectionTitle_1stvu_1091",Be="_urgentActions_1stvu_1100",Se="_actionCard_1stvu_1104",Te="_actionHeader_1stvu_1115",Le="_actionTitle_1stvu_1122",Pe="_actionDeadline_1stvu_1128",Me="_actionWhy_1stvu_1136",De="_actionImpact_1stvu_1143",He="_actionSteps_1stvu_1150",We="_weeklyCheckIn_1stvu_1161",qe="_statusGrid_1stvu_1165",Ee="_statusItem_1stvu_1171",Qe="_statusLabel_1stvu_1177",ze="_bigPicture_1stvu_1194",Fe="_nextStepsSection_1stvu_1208",Ge="_focusGrid_1stvu_1212",Oe="_focusItem_1stvu_1218",Ve="_focusLabel_1stvu_1224",$e="_loadingAnalysis_1stvu_1241",Re="_typingDemo_1stvu_1267",Ye="_typingBubble_1stvu_1271",Je="_typingText_1stvu_1281",Ke="_typingCursor_1stvu_1287",Ue="_testimonialQuote_1stvu_1301",Xe="_quoteIcon_1stvu_1310",Ze="_quoteText_1stvu_1318",es="_quoteAuthor_1stvu_1326",s={container:D,mainPanel:H,header:W,headerContent:q,title:E,subtitle:Q,documentBadge:z,headerActions:F,memoButton:G,contextButton:O,contextBar:V,contextLabel:$,contextBadge:R,contextEmpty:Y,chatArea:J,welcome:K,welcomeIcon:U,emptyState:X,lockIcon:Z,requirements:ee,completeOnboardingBtn:se,starterQuestions:te,starterLabel:ne,starterQuestion:ae,messages:oe,message:ie,userMessage:ce,messageContent:re,assistantMessage:le,citations:de,citationLabel:ue,citation:he,typingIndicator:me,inputArea:xe,input:_e,sendButton:pe,memoPanel:ve,memoPanelTitle:je,memoEmpty:ge,memoList:ye,memoCard:Ne,memoDate:fe,proactivePanel:ke,proactiveHeader:be,proactiveTitle:we,proactiveClose:Ce,proactiveGreeting:Ie,sectionTitle:Ae,urgentActions:Be,actionCard:Se,actionHeader:Te,actionTitle:Le,actionDeadline:Pe,actionWhy:Me,actionImpact:De,actionSteps:He,weeklyCheckIn:We,statusGrid:qe,statusItem:Ee,statusLabel:Qe,bigPicture:ze,nextStepsSection:Fe,focusGrid:Ge,focusItem:Oe,focusLabel:Ve,loadingAnalysis:$e,typingDemo:Re,typingBubble:Ye,typingText:Je,typingCursor:Ke,testimonialQuote:Ue,quoteIcon:Xe,quoteText:Ze,quoteAuthor:es};function ts(){const[r,x]=i.useState([]),[u,_]=i.useState(""),[d,h]=i.useState(!1),[p,v]=i.useState(!1),[j,g]=i.useState([]),[c,b]=i.useState(null),y=i.useRef(null),[a,w]=i.useState(null),[C,N]=i.useState(!1),[I,A]=i.useState(!0);i.useEffect(()=>{B(),S(),T()},[]),i.useEffect(()=>{y.current?.scrollIntoView({behavior:"smooth"})},[r]);const B=async()=>{try{const t=await fetch("/api/charge-ai/context",{credentials:"include"});if(t.ok){const n=await t.json();b(n)}}catch(t){console.error("Failed to load context:",t)}},S=async()=>{try{const t=await fetch("/api/charge-ai/memos",{credentials:"include"});if(t.ok){const n=await t.json();g(n.memos||[])}}catch(t){console.error("Failed to load memos:",t)}},T=async()=>{N(!0);try{const t=await fetch("/api/charge-ai/proactive-analysis",{credentials:"include"});if(t.ok){const n=await t.json();n.hasAnalysis&&n.analysis&&w(n.analysis)}}catch(t){console.error("Failed to load proactive analysis:",t)}finally{N(!1)}},f=async()=>{if(!u.trim()||d)return;const t={role:"user",content:u.trim(),timestamp:new Date};x(n=>[...n,t]),_(""),h(!0);try{const n=await fetch("/api/charge-ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({message:t.content,conversationHistory:r.map(m=>({role:m.role,content:m.content}))})});if(!n.ok)throw new Error("Failed to get response");const o=await n.json(),l={role:"assistant",content:o.response,timestamp:new Date,citations:o.citations};x(m=>[...m,l])}catch(n){console.error("Chat error:",n),x(o=>[...o,{role:"assistant",content:"I encountered an issue processing your request. Please try again.",timestamp:new Date}])}finally{h(!1)}},L=async()=>{if(!(r.length<2)){h(!0);try{const t=await fetch("/api/charge-ai/generate-memo",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({messages:r.map(n=>({role:n.role,content:n.content}))})});if(t.ok){const n=await t.json();g(o=>[n.memo,...o]),v(!0)}}catch(t){console.error("Failed to generate memo:",t)}finally{h(!1)}}},P=["How much will I save if I max out my 401k this year?","What's my current tax situation and biggest opportunities?","Help me build my financial profile step by step","What should I focus on first given my situation?"],k=c?.hasTaxData||c?.hasPositions||c?.hasProfile;return e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.mainPanel,children:[e.jsxs("div",{className:s.header,children:[e.jsxs("div",{className:s.headerContent,children:[e.jsx("h1",{className:s.title,children:"AI Advisor"}),e.jsx("p",{className:s.subtitle,children:"Your private decision engine"}),c?.hasAnalyzedDocuments&&e.jsxs("div",{className:s.documentBadge,children:[e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"14",height:"14",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),e.jsxs("span",{children:["AI has analyzed ",c.documentCount||1," document",(c.documentCount||1)>1?"s":""]})]})]}),e.jsxs("div",{className:s.headerActions,children:[r.length>=2&&e.jsxs("button",{className:s.memoButton,onClick:L,disabled:d,children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Save Memo"]}),e.jsxs("button",{className:s.contextButton,onClick:()=>v(!p),children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),e.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]}),p?"Hide":"Memos"]})]})]}),c&&e.jsxs("div",{className:s.contextBar,children:[e.jsx("span",{className:s.contextLabel,children:"Your data:"}),c.hasProfile&&e.jsx("span",{className:s.contextBadge,children:"Profile"}),c.hasTaxData&&e.jsx("span",{className:s.contextBadge,children:"Tax Return"}),c.hasPositions&&e.jsx("span",{className:s.contextBadge,children:"Portfolio"}),!k&&e.jsx("span",{className:s.contextEmpty,children:"No data uploaded yet"})]}),e.jsx("div",{className:s.chatArea,children:r.length===0?e.jsx("div",{className:s.welcome,children:a&&I?e.jsxs("div",{className:s.proactivePanel,children:[e.jsxs("div",{className:s.proactiveHeader,children:[e.jsxs("div",{className:s.proactiveTitle,children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"})}),e.jsx("span",{children:"Your Personal CFO Update"})]}),e.jsx("button",{className:s.proactiveClose,onClick:()=>A(!1),children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),e.jsx("p",{className:s.proactiveGreeting,children:a.greeting}),a.urgentActions&&a.urgentActions.length>0&&e.jsxs("div",{className:s.urgentActions,children:[e.jsx("h3",{className:s.sectionTitle,children:"Action Items"}),a.urgentActions.map((t,n)=>e.jsxs("div",{className:s.actionCard,children:[e.jsxs("div",{className:s.actionHeader,children:[e.jsx("span",{className:s.actionTitle,children:t.title}),t.deadline&&e.jsx("span",{className:s.actionDeadline,children:t.deadline})]}),e.jsx("p",{className:s.actionWhy,children:t.why}),e.jsxs("div",{className:s.actionImpact,children:["Impact: ",t.impact]}),t.steps&&t.steps.length>0&&e.jsx("ol",{className:s.actionSteps,children:t.steps.map((o,l)=>e.jsx("li",{children:o},l))})]},n))]}),a.weeklyCheckIn&&e.jsxs("div",{className:s.weeklyCheckIn,children:[e.jsx("h3",{className:s.sectionTitle,children:"Status Check"}),e.jsxs("div",{className:s.statusGrid,children:[e.jsxs("div",{className:s.statusItem,children:[e.jsx("span",{className:s.statusLabel,children:"Portfolio"}),e.jsx("p",{children:a.weeklyCheckIn.portfolioStatus})]}),e.jsxs("div",{className:s.statusItem,children:[e.jsx("span",{className:s.statusLabel,children:"Taxes"}),e.jsx("p",{children:a.weeklyCheckIn.taxStatus})]}),e.jsxs("div",{className:s.statusItem,children:[e.jsx("span",{className:s.statusLabel,children:"Cash Flow"}),e.jsx("p",{children:a.weeklyCheckIn.cashFlowStatus})]})]})]}),e.jsxs("div",{className:s.bigPicture,children:[e.jsx("h3",{className:s.sectionTitle,children:"Big Picture"}),e.jsx("p",{children:a.bigPictureInsight})]}),a.nextSteps&&e.jsxs("div",{className:s.nextStepsSection,children:[e.jsx("h3",{className:s.sectionTitle,children:"Focus Areas"}),e.jsxs("div",{className:s.focusGrid,children:[e.jsxs("div",{className:s.focusItem,children:[e.jsx("span",{className:s.focusLabel,children:"This Week"}),e.jsx("p",{children:a.nextSteps.thisWeek})]}),e.jsxs("div",{className:s.focusItem,children:[e.jsx("span",{className:s.focusLabel,children:"This Month"}),e.jsx("p",{children:a.nextSteps.thisMonth})]}),e.jsxs("div",{className:s.focusItem,children:[e.jsx("span",{className:s.focusLabel,children:"This Quarter"}),e.jsx("p",{children:a.nextSteps.thisQuarter})]})]})]})]}):C?e.jsx("div",{className:s.loadingAnalysis,children:e.jsx(M,{size:"large",text:"Analyzing your financial situation..."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:s.welcomeIcon,children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"}),e.jsx("circle",{cx:"8",cy:"14",r:"1.5"}),e.jsx("circle",{cx:"16",cy:"14",r:"1.5"})]})}),k?e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Ask any financial question"}),e.jsx("p",{children:"I'll analyze your data and give you specific answers with real numbers."})]}):e.jsxs("div",{className:s.emptyState,children:[e.jsx("div",{className:s.typingDemo,children:e.jsxs("div",{className:s.typingBubble,children:[e.jsx("span",{className:s.typingText,children:'"How can I reduce my tax bill by $5,000 this year?"'}),e.jsx("span",{className:s.typingCursor})]})}),e.jsx("div",{className:s.lockIcon,children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"5",y:"11",width:"14",height:"10",rx:"2",ry:"2"}),e.jsx("path",{d:"M12 17v-3"}),e.jsx("path",{d:"M7 11V7a5 5 0 0110 0v4"})]})}),e.jsx("h2",{children:"Complete Onboarding to Unlock AI Advisor"}),e.jsx("p",{children:"To provide personalized insights, I need information about your:"}),e.jsxs("ul",{className:s.requirements,children:[e.jsxs("li",{children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Tax profile and income"]}),e.jsxs("li",{children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Investment portfolio"]}),e.jsxs("li",{children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Tax documents (optional)"]})]}),e.jsxs("div",{className:s.testimonialQuote,children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:s.quoteIcon,children:e.jsx("path",{d:"M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"})}),e.jsx("p",{className:s.quoteText,children:`"Found $12,000 in tax savings I didn't know existed. The AI advisor paid for itself in the first conversation."`}),e.jsx("span",{className:s.quoteAuthor,children:"â€” Sarah K., Tech Executive"})]}),e.jsxs("button",{className:s.completeOnboardingBtn,onClick:()=>window.location.href="/dashboard?showOnboarding=true",children:["Complete Onboarding (5 min)",e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M5 12h14M12 5l7 7-7 7"})})]})]}),e.jsxs("div",{className:s.starterQuestions,children:[e.jsx("span",{className:s.starterLabel,children:"Try asking:"}),P.map((t,n)=>e.jsx("button",{className:s.starterQuestion,onClick:()=>_(t),children:t},n))]})]})}):e.jsxs("div",{className:s.messages,children:[r.map((t,n)=>e.jsxs("div",{className:`${s.message} ${t.role==="user"?s.userMessage:s.assistantMessage}`,children:[e.jsx("div",{className:s.messageContent,children:t.content.split(`
`).map((o,l)=>e.jsx("p",{children:o},l))}),t.citations&&t.citations.length>0&&e.jsxs("div",{className:s.citations,children:[e.jsx("span",{className:s.citationLabel,children:"Based on:"}),t.citations.map((o,l)=>e.jsx("span",{className:s.citation,children:o},l))]})]},n)),d&&e.jsx("div",{className:`${s.message} ${s.assistantMessage}`,children:e.jsxs("div",{className:s.typingIndicator,children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})}),e.jsx("div",{ref:y})]})}),e.jsxs("div",{className:s.inputArea,children:[e.jsx("input",{type:"text",value:u,onChange:t=>_(t.target.value),onKeyDown:t=>t.key==="Enter"&&f(),placeholder:"Ask a question about your finances...",className:s.input,disabled:d}),e.jsx("button",{onClick:f,className:s.sendButton,disabled:!u.trim()||d,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),e.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),p&&e.jsxs("div",{className:s.memoPanel,children:[e.jsx("h3",{className:s.memoPanelTitle,children:"Saved Memos"}),j.length===0?e.jsx("div",{className:s.memoEmpty,children:e.jsx("p",{children:"Save important insights and decisions for later reference."})}):e.jsx("div",{className:s.memoList,children:j.map(t=>e.jsxs("div",{className:s.memoCard,children:[e.jsx("h4",{children:t.title}),e.jsx("p",{children:t.summary}),e.jsx("span",{className:s.memoDate,children:new Date(t.createdAt).toLocaleDateString()})]},t.id))})]})]})}export{ts as default};
